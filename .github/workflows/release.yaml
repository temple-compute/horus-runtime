name: Release

on:
    release:
        types: [published]

jobs:
    release:
        runs-on: ubuntu-latest
        permissions:
            id-token: write

        steps:
            - uses: actions/checkout@v6

            - name: Set up Python
              uses: actions/setup-python@v6
              with:
                  python-version: "3.13"
                  cache: "pip"

            - name: Install dependencies
              run: |
                  pip install -e .[dev]
                  pip install build

            - name: Verify and compile translations
              run: make babel-check

            - name: Build package
              run: python -m build

            - name: Upload to PyPI
              uses: pypa/gh-action-pypi-publish@release/v1
